CREATE TABLE motoclube.disciplinary_measures
(
    id                  BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    created_at          TIMESTAMP WITHOUT TIME ZONE,
    updated_at          TIMESTAMP WITHOUT TIME ZONE,
    deleted_at          TIMESTAMP WITHOUT TIME ZONE,
    modified_by_user_id BIGINT,
    deleted_by_user_id  BIGINT,
    created_by_user_id  BIGINT,
    tipo                SMALLINT,
    start_date          date,
    end_date            date,
    reason              VARCHAR(255),
    member_id           BIGINT,
    CONSTRAINT pk_disciplinary_measures PRIMARY KEY (id)
);

ALTER TABLE motoclube.disciplinary_measures
    ADD CONSTRAINT FK_DISCIPLINARY_MEASURES_ON_CREATEDBYUSER FOREIGN KEY (created_by_user_id) REFERENCES motoclube.users (id);

ALTER TABLE motoclube.disciplinary_measures
    ADD CONSTRAINT FK_DISCIPLINARY_MEASURES_ON_DELETEDBYUSER FOREIGN KEY (deleted_by_user_id) REFERENCES motoclube.users (id);

ALTER TABLE motoclube.disciplinary_measures
    ADD CONSTRAINT FK_DISCIPLINARY_MEASURES_ON_MEMBER FOREIGN KEY (member_id) REFERENCES motoclube.member (id);

ALTER TABLE motoclube.disciplinary_measures
    ADD CONSTRAINT FK_DISCIPLINARY_MEASURES_ON_MODIFIEDBYUSER FOREIGN KEY (modified_by_user_id) REFERENCES motoclube.users (id);

ALTER TABLE motoclube_audit.member_audit
    DROP CONSTRAINT fk_member_audit_on_rev;

CREATE TABLE motoclube_audit.disciplinary_measures_audit
(
    rev                 INTEGER NOT NULL,
    created_at          TIMESTAMP WITHOUT TIME ZONE,
    updated_at          TIMESTAMP WITHOUT TIME ZONE,
    deleted_at          TIMESTAMP WITHOUT TIME ZONE,
    modified_by_user_id BIGINT,
    deleted_by_user_id  BIGINT,
    created_by_user_id  BIGINT,
    revtype             SMALLINT,
    id                  BIGINT  NOT NULL,
    tipo                SMALLINT,
    start_date          date,
    end_date            date,
    reason              VARCHAR(255),
    member_id           BIGINT,
    CONSTRAINT pk_disciplinary_measures_audit PRIMARY KEY (rev, id)
);

ALTER TABLE motoclube_audit.disciplinary_measures_audit
    ADD CONSTRAINT FK_DISCIPLINARY_MEASURES_AUDIT_ON_REV FOREIGN KEY (rev) REFERENCES revinfo (rev);